<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Edge DevOps :: Cloud Native Robotz Hackathon</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/course-template/modules/stable/edge-devops.html">
    <link rel="prev" href="integration.html">
    <link rel="next" href="final-run.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://demo.redhat.com" target="_blank">
        <img src="../../_/img/rhdp-logo.svg" height="35px" alt="Red Hat Demo Platform">
      </a>
      <a class="navbar-item" href="https://redhat-scholars.github.io/course-template">Cloud Native Robotz Hackathon</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Help</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://redhat.service-now.com/help?id=sc_cat_item&sys_id=00c0316a1bf39450e43942a7bc4bcbd1">Open Support Case</a>
            <a class="navbar-item" target="_blank" href="https://rhdp.statuspage.io/">Status Page</a>
            <a class="navbar-item" target="_blank" href="https://demo.redhat.com/support">Solution Support: Service Level</a>
            <a class="navbar-item" target="_blank" href="https://content.redhat.com/us/en/product/cross-portfolio-initiatives/rhdp.html">Learn more</a>
            <a class="navbar-item" target="_blank" href="https://videos.learning.redhat.com/channel/RHPDS%2B-%2BRed%2BHat%2BProduct%2Band%2BPortfolio%2BDemo%2BSystem/277722533">How to videos</a>
          </div>
        </div>
        <a class="navbar-item" target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSfwGW7ql2lDfaLDpg4Bgj_puFEVsM0El6-Nz8fyH48RnGLDrA/viewform">Feedback</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="modules" data-version="stable">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Lab guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="data-science.html">0. Data Science</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="development.html">1. Development</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="integration.html">2. Integration</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="edge-devops.html">3. Edge DevOps</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="final-run.html">4. Final Run</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lab guide</span>
    <span class="version">stable</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Lab guide</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">stable</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Lab guide</a></li>
    <li><a href="edge-devops.html">3. Edge DevOps</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/cloud-native-robotz-hackathon/lab-guide/edit/main/content/modules/ROOT/pages/edge-devops.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Edge DevOps</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Testing our solution on OpenShift is fun but what we really want is an autonomous robot that can think for itself and find our fedora in the most disconnected of places.</p>
</div>
<div class="paragraph">
<p>As you read in the last chapter at the "Feature Freeze" you will have to provide your solution assets in the form of container images.  It is time to move these onto the robot itself.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_todo_architecture_overview"><a class="anchor" href="#_todo_architecture_overview"></a>ToDo: Architecture overview</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_build_a_container_image_of_the_object_detection_model"><a class="anchor" href="#_build_a_container_image_of_the_object_detection_model"></a>Build a Container Image of the Object Detection Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once we are finished with tuning our object detection model we will package it into a container image to be deployed on the robot.</p>
</div>
<div class="paragraph">
<p>An OpenShift pipeline based on Tekton has been prepared for you</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login into the <a href="https://console-openshift-console.apps.example.com" target="_blank" rel="noopener">OpenShift Console</a> with username: team-1 and password : secret-password</p>
</li>
<li>
<p>Go to the the project team-1-ai</p>
</li>
<li>
<p>Click <strong>Pipelines</strong> on the left</p>
</li>
<li>
<p>Click on the Pipeline <code>model-image-build</code></p>
</li>
<li>
<p>Click on Actions &#8594; Start</p>
<div class="imageblock">
<div class="content">
<img src="_images/edge-devops/start-pipeline.png" alt="start pipeline">
</div>
</div>
</li>
<li>
<p>Click on Start to start the pipeline</p>
<div class="imageblock">
<div class="content">
<img src="_images/edge-devops/start-pipeline-2.png" alt="start pipeline 2">
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_a_container_image_of_the_application"><a class="anchor" href="#_build_a_container_image_of_the_application"></a>Build a Container Image of the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When done with the app we will package it in a Container Image as well.</p>
</div>
<div class="paragraph">
<p>A matching pipeline has been added to your template app repository. This pipeline is triggered by the creation of a Tag in Gitea. So once you are ready, all you need to do is create a Tag and the Pipeline will build and push the Image to the local OpenShift Registry.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login into <a href="https://gitea.apps.example.com/team-1/starter-app-python">Gitea</a> with</p>
<div class="ulist">
<ul>
<li>
<p>username: team-1</p>
</li>
<li>
<p>password : secret-password</p>
</li>
</ul>
</div>
</li>
<li>
<p>Select the repository <code>starter-app-python</code></p>
</li>
<li>
<p>Click on <strong>Releases</strong></p>
<div class="imageblock">
<div class="content">
<img src="_images/gitea-release.png" alt="gitea release">
</div>
</div>
</li>
<li>
<p>Click on <strong>New Release</strong></p>
</li>
<li>
<p>Enter the <strong>Tag name</strong>  <code>v1</code></p>
</li>
<li>
<p>Click on the button <strong>Create Tag Only</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can go back to the OpenShift Console and click on <strong>Pipelines</strong> in the menu on the left. Make sure you are in the <strong>Project</strong> <code>team-1-dev</code>. You should see you Pipeline running.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_you_images_to_robot_with_gitops"><a class="anchor" href="#_deploy_you_images_to_robot_with_gitops"></a>Deploy you Images to Robot with GitOps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have the images we can deploy them to the robot.  Since the robots are running Microshift (a lightweight version of OpenShift) we can use consistent tooling to automate our Deployment. We will use <strong>OpenShift GitOps</strong> based on ArgoCD for this.</p>
</div>
<div class="paragraph">
<p>A <strong>OpenShift GitOps</strong> project has already been setup that listens to changes of a configuration repository. The microshift of your robot as been added as manged cluster so any change in the repo will be rolled out diretcly to your robot. All you need to do is update the configuration code in Gitea.</p>
</div>
<div class="paragraph">
<p>Have a look at the Git repo : <a href="https://gitea.apps.example.com/team-1/robot-gitops" class="bare">https://gitea.apps.example.com/team-1/robot-gitops</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The object detection image needs to be set here:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://gitea.apps.example.com/team-1/robot-gitops/src/branch/main/base/namespace/triton/deployment.yaml" class="bare">https://gitea.apps.example.com/team-1/robot-gitops/src/branch/main/base/namespace/triton/deployment.yaml</a></p>
<div class="ulist">
<ul>
<li>
<p>Click on the pen icon on the top right to edit the file</p>
</li>
<li>
<p>In the resource yaml look for the field <code>image</code> with the value <code>quay.io/cloud-native-robotz-hackathon/model-container:trained</code></p>
</li>
<li>
<p>Replace the value with <code>default-route-openshift-image-registry.apps.example.com/team-1/model-container:latest</code></p>
</li>
<li>
<p>Click on the <strong>Commit Changes</strong> Button at the very bottom</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The app image needs to be set here:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://gitea.apps.example.com/team-1/robot-gitops/src/branch/main/base/namespace/robot-app/deployment.yaml" class="bare">https://gitea.apps.example.com/team-1/robot-gitops/src/branch/main/base/namespace/robot-app/deployment.yaml</a></p>
<div class="ulist">
<ul>
<li>
<p>Click on the pen icon on the top right to edit the file</p>
</li>
<li>
<p>In the resource yaml look for the field <code>image</code> with the value <code>quay.io/cloud-native-robotz-hackathon/starter-app-python:master</code></p>
</li>
<li>
<p>Replace the value with <code>default-route-openshift-image-registry.apps.example.com/team-1-dev/starter-app-python:v1</code></p>
</li>
<li>
<p>Click on the <strong>Commit Changes</strong> Button at the very bottom</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In real world projects, you would use a tool such as <strong>Kustomize</strong> to add modification layer without changing the actual deployment.yaml files
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you commit the changes <strong>OpenShift GitOps</strong> will start to work on the deployment. Keep an eye on the ArgoCD Console shown by facilitators.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="integration.html" class="query-params-link">2. Integration</a></span>
  <span class="next"><a href="final-run.html" class="query-params-link">4. Final Run</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
